<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Quiz</title>
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

</head>

<body>

    <header>

        <h1>
            Coding Quiz Challenge!
        </h1>
        <!-- Start Button -->
        <button id="start" class="buttons">
            Start Quiz
        </button>
        <!-- Finish button -->
        <button id="finish" class="buttons">
            Finish Quiz
        </button>
        <!-- This will display the final score at the end of the Quiz -->
        <div id="finalScore">
            <h2>
                Final Score <br>
                <!-- This holds the value for the score -->
                <span id="score"></span>
            </h2>
            
            <!-- Input text field for user name -->
            <br>
            <input id="nameInput" type="text" placeholder="Insert name here" value="">
            <br>
            <!-- Submit button, it only appears at the end of the first try or when score its higher -->
            <button id="submit" class="buttons">
                Submit Score
            </button>

        </div>

    </header>

    <section>
        <!-- This will display the questions and answers -->
        <div>
            <p id="questions">
                test questions
            </p>
        </div>

        <ul>
            <li>
                <button id="answer1" class="buttons answer" data-value="">

                </button>
            </li>

            <li>
                <button id="answer2" class="buttons answer">

                </button>
            </li>

            <li>
                <button id="answer3" class="buttons answer">

                </button>
            </li>

        </ul>
        <!-- This will show the remaining time -->
        <div>
            <h3 id="secondsRemaining">
                Seconds Remaining:
                <br>
                <span id="timer"></span>
            </h3>
            
        </div>

    </section>

    <div>
        <!-- This will display the Higher score, the value will be loaded from local storage -->
        <h3 id="higherScoreData" data-value=0>
            Highest Score
            <br>
            <span id="highestScoreName"></span>
            <br>
            <span id="higherScore"></span>
            <br>
            <!-- Try again button -->
            <button id="tryAgain" class="buttons">
                Try Again
            </button>
        </h3>

    </div>

    <script src="https://code.jquery.com/jquery.js"></script>
    <script type="text/javascript">

        
        $(document).ready(function () {
            //This variable holds HTML questions, may use them later
            /*var questionsHTML = [
    
                {
                    question: "Who is making the Web standards?",
                    answer1: { text: "Mozilla", value: "" },
                    answer2: { text: "Microsoft", value: "" },
                    answer3: { text: "The World Wide Web Consortium", value: true }
                },
    
                {
                    question: "What does CSS stand for?",
                    answer1: { text: "Creative Style Sheets", value: "" },
                    answer2: { text: "Colorful Style Sheets", value: "" },
                    answer3: { text: "Cascading Style Sheets", value: true }
                },
    
                {
                    question: "Which is the correct CSS syntax?",
                    answer1: { text: "body:color=black", value: "" },
                    answer2: { text: "{body;color:black}", value: "" },
                    answer3: { text: "body {color: black}", value: true }
                },
    
                {
                    question: "How do you insert a comment in a CSS file?",
                    answer1: { text: "/* this is a comment *//*", value: true },
            answer2: { text: "/ this is a comment", value: "" },
            answer3: { text: "// this is a comment //", value: "" }
        },

        {
            question: "How can you make a list that lists the items with numbers?",
            answer1: { text: "ol", value: true },
            answer2: { text: "dl", value: "" },
            answer3: { text: "ul", value: "" }
        },

        {
            question: "Choose the correct HTML tag for the largest heading.",
            answer1: { text: "head", value: "" },
            answer2: { text: "h1", value: "" },
            answer3: { text: "header", value: true }
        },

        {
            question: "How do you display hyperlinks without an underline?",
            answer1: { text: "a {text-decoration:none}", value: true },
            answer2: { text: "a {underline:none}", value: "" },
            answer3: { text: "a {decoration:no underline}", value: "" }
        },

        {
            question: "How do you make a list that lists its items with squares?",
            answer1: { text: "list-style-type: square", value: true },
            answer2: { text: "type: 2", value: "" },
            answer3: { text: "list-type: square", value: "" }
        },

        {
            question: "In what form are style rules presented?",
            answer1: { text: "selector { property= value }", value: "" },
            answer2: { text: "selector ( property: value )", value: true },
            answer3: { text: "selector ( property= value )", value: "" }
        },

        {
            question: "Which property applies a color to text?",
            answer1: { text: "text-color", value: "" },
            answer2: { text: "color", value: true },
            answer3: { text: "background-color", value: "" }
        },

        {
            question: "What does the ID selector do?",
            answer1: { text: "Apply the style to a specific element", value: true },
            answer2: { text: "Apply the style to all the elements", value: "" },
            answer3: { text: "Apply the style to a group of elements", value: "" }
        },

        {
            question: "What selector should you use when applying a style to multiple elements?",
            answer1: { text: "ID", value: "" },
            answer2: { text: "Class", value: true },
            answer3: { text: "Type", value: "" }
        },

        {
            question: "Which of the following attributes of the <img> tag displays alternate text for the image?",
            answer1: { text: "text", value: "" },
            answer2: { text: "caption", value: "" },
            answer3: { text: "alt", value: true }
        },

        {
            question: "Where in the HTML document is the correct place to refer to an external style sheet?",
            answer1: { text: "In the <body> section", value: "" },
            answer2: { text: "At the top of the document", value: "" },
            answer3: { text: "In the <head> section", value: true }
        },

        {
            question: "Which HTML tag is used to define an internal style sheet?",
            answer1: { text: "<css>", value: "" },
            answer2: { text: "<style>", value: true },
            answer3: { text: "<script>", value: "" }
        },

        {
            question: "Which HTML attribute is used to define inline styles?",
            answer1: { text: "styles", value: "" },
            answer2: { text: "style", value: true },
            answer3: { text: "class", value: "" }
        },

        {
            question: "What does HTML stand for?",
            answer1: { text: "Hyper Text Markup Language", value: true },
            answer2: { text: "Home Tool Markup Language", value: "" },
            answer3: { text: "Hyperlinks and Text Markup Language", value: "" }
        },

    ];*/
            //Holds all the questions as objects inside an array
            var questions = [
                {
                    question: "Inside which HTML element do we put the JavaScript?",
                    answer1: { text: "<javascript>", value: "" },
                    answer2: { text: "<script>", value: true },
                    answer3: { text: "<js>", value: "" }
                },
                {
                    question: "Where is the correct place to insert a JavaScript?",
                    answer1: { text: "the <head> section", value: true },
                    answer2: { text: "the <body> section", value: "" },
                    answer3: { text: "both are correct", value: "" }
                },
                {
                    question: "What is the correct syntax for referring to an external script called xxx.js?",
                    answer1: { text: "<script src='xxx.js'", value: true },
                    answer2: { text: "<script name=xxx.js", value: "" },
                    answer3: { text: "<script href=xxx.js", value: "" }
                },
                {
                    question: "The external JavaScript file must contain the <script> tag.",
                    answer1: { text: "false", value: true },
                    answer2: { text: "true", value: "" },
                    answer3: { text: "?", value: "" }
                },
                {
                    question: "How do you write <Hello World> in an alert box?",
                    answer1: { text: "alert('hello world')", value: true },
                    answer2: { text: "alertBox(hello world)", value: "" },
                    answer3: { text: "msgBox(hello world)", value: "" }
                },
                {
                    question: "How do you create a function in JavaScript?",
                    answer1: { text: "function:myFunction()", value: "" },
                    answer2: { text: "function myFunction()", value: true },
                    answer3: { text: "function=myFunction()", value: "" }
                },
                {
                    question: "How do you call a function named <myFunction>?",
                    answer1: { text: "call Function myFunction", value: "" },
                    answer2: { text: "call myFunction", value: "" },
                    answer3: { text: "MyFunction()", value: true }
                },
                {
                    question: "How to write an IF statement in JavaScript?",
                    answer1: { text: "if i=5", value: "" },
                    answer2: { text: "if(i==5)", value: true },
                    answer3: { text: "if i==5 then", value: "" }
                },
                {
                    question: "How to write an IF statement for executing some code if <i> is NOT equal to 5?",
                    answer1: { text: "if (i!=5)", value: true },
                    answer2: { text: "if i!=5", value: "" },
                    answer3: { text: "if i<>5", value: "" }
                },
                {
                    question: "How does a WHILE loop start?",
                    answer1: { text: "while (i<=10;i++)", value: "" },
                    answer2: { text: "while (i<=10)", value: true },
                    answer3: { text: "while i=10", value: "" }
                },
                {
                    question: "How does a FOR loop start?",
                    answer1: { text: "for (i<=5;i++)", value: "" },
                    answer2: { text: "for i = 1 to 5", value: "" },
                    answer3: { text: "for (i=0; i<=5; i++)", value: true }
                },
                {
                    question: "How can you add a comment in a JavaScript?",
                    answer1: { text: "//This is a comment", value: true },
                    answer2: { text: "'This is a comment'", value: "" },
                    answer3: { text: "<!This is a comment--", value: "" }
                },
                {
                    question: "How to insert a comment that has more than one line?",
                    answer1: { text: "<This comment has more than one line>", value: "" },
                    answer2: { text: "/*This comment has more than one line*/", value: true },
                    answer3: { text: "//This comment has more than one line//", value: "" }
                },
                {
                    question: "What is the correct way to write a JavaScript array?",
                    answer1: { text: "var colors = ['red', 'green', 'blue']", value: true },
                    answer2: { text: "var colors = 'red', 'green', 'blue'", value: "" },
                    answer3: { text: "var colors = ('red', 'green', 'blue')", value: "" }
                },
                {
                    question: "How do you round the number 7.25, to the nearest integer?",
                    answer1: { text: "round(7.25)", value: "" },
                    answer2: { text: "rnd(7.25)", value: "" },
                    answer3: { text: "Math.round(7.25)", value: true }
                },
                {
                    question: "How do you find the number with the highest value of x and y?",
                    answer1: { text: "Math.ceil(x,y)", value: true },
                    answer2: { text: "Math.max(x,y)", value: "" },
                    answer3: { text: "ceil(x,y)", value: "" }
                },
                {
                    question: "What is the correct JavaScript syntax for opening a new window called 'w2' ?",
                    answer1: { text: "w2 = window.open('http://w3schools.com')", value: true },
                    answer2: { text: "w2 = window.new('http://w3schools.com')", value: "" },
                    answer3: { text: "w2 = window.target:blank('http://w3schools.com')", value: "" }
                },
                {
                    question: "JavaScript is the same as Java.",
                    answer1: { text: "true", value: "" },
                    answer2: { text: "false", value: true },
                    answer3: { text: "?", value: "" }
                },
                {
                    question: "How can you detect the client's browser name?",
                    answer1: { text: "navigator.appName", value: true },
                    answer2: { text: "browser name", value: "" },
                    answer3: { text: "client.navName", value: "" }
                },
                {
                    question: "Which event occurs when the user clicks on an HTML element?",
                    answer1: { text: "onchange", value: "" },
                    answer2: { text: "onclick", value: true },
                    answer3: { text: "onmouseclik", value: "" }
                },
                {
                    question: "How do you declare a JavaScript variable?",
                    answer1: { text: "var carName", value: true },
                    answer2: { text: "variable carName", value: "" },
                    answer3: { text: "v carName", value: "" }
                },
                {
                    question: "Which operator is used to assign a value to a variable?",
                    answer1: { text: "=", value: true },
                    answer2: { text: "*", value: "" },
                    answer3: { text: "==", value: "" }
                },
            ];
                //this object holds the values that will be saved to the local storage. 
            var scoreObject = { highScore: 0, name: "" }
            var questionTextField = $("#questions");
            var buttonAnswer = $(".answer");
            var startBtn = $("#start");
            var submitFinalScore = $("#submit");
            var tryAgainBtn = $("#tryAgain");
                //this var holds the value of the remaining time, time's depends on the questions array length.
            var timeLeft = questions.length * 5;

                //this var its used the circle thought the array
            var i = 0;
                //this var holds the value of the score when user respond correctly
            var finalScore = 0;
                //this var its used to stop the setInterval function
            var timer;

                //this function circle thought the questions array an show the questions and answers
            function questionnaire() {
                
                //this will finish the quiz if user reach the final object in the questions array 
                if (i==questions.length) {
                    finishedQuestionnaire();
                }
                questionTextField.text(questions[i].question);
                $("#answer1").text(questions[i].answer1.text);
                $("#answer1").attr("data-value", questions[i].answer1.value);

                $("#answer2").text(questions[i].answer2.text);
                $("#answer2").attr("data-value", questions[i].answer2.value);

                $("#answer3").text(questions[i].answer3.text);
                $("#answer3").attr("data-value", questions[i].answer3.value);

                //this will add 1 to the var i to circle thought the questions array
                i = parseInt(i) + 1;
            }

            //this function when run will finish the quiz, also will hide elements, show some other elements 
            function finishedQuestionnaire() {
                
                let dataValue = $("#higherScore").attr("data-value");
                
                //this will show the submit button at the first round of the game or when user beats higher score
                if (finalScore > dataValue||dataValue == undefined) {

                    $("#submit").css({ display: "initial" });
                    $("#nameInput").css({ display: "initial" });
                    $("#labelNameInput").css({ display: "initial" });
                
                //if user fails to beat old score it will have the option to try again
                } else { tryAgainBtn.css({ display: "initial" }); };
                //this will show the finalScore element
                $("#finalScore").css({ display: "initial" });
                //this will add the class fade in to finalScore
                $("#finalScore").addClass("fade-in");
                //this will set the text of finalScore
                $("#score").text(Math.floor(finalScore));
                //this will hide the questions and answers element
                $("section").css({ display: "none" });
                //this will reset the timeLeft
                timeLeft = questions.length * 5;
                //this will reset the value to circle thought the questions array
                i = 0;
                //this will stop the setInterval function
                clearInterval(timer);
            }

            //this function will start the timer when timer gets to 0 it will end the quiz
            function startTimer() {
                timer = setInterval(function () {
                    timeLeft = timeLeft - 1;
                    $("#timer").text(timeLeft);
                    if (timeLeft == 0) {
                        finishedQuestionnaire();
                    }
                }, 1000);
            }
            //this function will get the values from the local storage
            function getSavedScore() {

                let lastScore = JSON.parse(localStorage.getItem("lastScore"));
                
                if (lastScore) {
                    //this will get the value of the score
                    if (lastScore.scoreObject.highScore) {
                        console.log(lastScore.scoreObject.highScore);
                        let higherScore = (Math.floor(lastScore.scoreObject.highScore));
                        $("#higherScore").attr("data-value", higherScore);
                        $("#higherScore").text($("#higherScore").attr("data-value") + " Points");
                    }
                    //this will get the value of the name
                    if (lastScore.scoreObject.name) {
                        console.log(lastScore.scoreObject.name);
                        let latestInputName = lastScore.scoreObject.name;
                        $("#highestScoreName").text(latestInputName);
                    }
                    //this will only show when theres any saved score
                    if (lastScore.scoreObject.highScore > 0) {
                        $("#higherScoreData").css({ display: "block" });
                    }
                }

            }

            //this will save the score and user name to local storage
            function saveScore() {
                let nameInput = $("#nameInput").val();
                scoreObject.highScore = finalScore;
                scoreObject.name = nameInput;
                localStorage.setItem("lastScore", JSON.stringify({ scoreObject })
                );
            }

            //this will listen for any answer click
            buttonAnswer.on("click", function () {
                //this will check if user clicked the correct answer and will add score depending on the length of the questions array
                if ($(this).attr("data-value") == "true") {
                    finalScore = finalScore + 100 / questions.length;

                } else {
                    //if user answer its wrong it will remove 3 secs from the time left
                    timeLeft = timeLeft - 3;
                }
                
                questionnaire();
            });

            //button to start the quiz, it hides this button and shows the questions and answer element
            startBtn.on("click", function () {
                startTimer();
                $("section").css({ display: "block" });
                $("section").addClass("fade-in");
                startBtn.css({ display: "none" });
                $("h1").css({ display: "none" });

                questionnaire();

            })
            //this button will only show at the end of the first try or when users beat the saved score
            submitFinalScore.on("click", function () {
                $("#higherScore").text(Math.floor(finalScore) + " Points");
                $("#highestScoreName").text($("#nameInput").val());
                $("#finalScore").css({ display: "none" });
                $("#higherScoreData").css({ display: "block" });
                //this will show the try again button
                tryAgainBtn.css({ display: "inline" });
                saveScore();
                finalScore = 0;
            })
            //this will let the user try again
            tryAgainBtn.on("click", function () {
                $("section").css({ display: "block" });
                $("section").addClass("fade-in");
                questionnaire();
                startTimer();
                tryAgainBtn.css({ display: "none" });
                $("#finalScore").css({ display: "none" });
                finalScore = 0;

            })

            //this function will run when pages loads or user refresh
            getSavedScore();
        });
    </script>

</body>

</html>